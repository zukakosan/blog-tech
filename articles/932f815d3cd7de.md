---
title: "Azure Storage Account ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã«ã¤ã„ã¦è€ƒãˆã¦ã¿ã‚‹"
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Azure","PaaS","authorization"]
published: false
---
# ã“ã‚Œã¯ä½•...?
[ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸BLOBå…±åŒä½œæˆè€…]ãƒ­ãƒ¼ãƒ«ã‚’ä»˜ä¸ã—ã¦ã„ãªã„ã®ã«BLOBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ç®¡ç†ãŒã§ãã¦ã„ã‚‹ã“ã¨ã‚’ä¸æ€è­°ã«æ€ã£ãŸã“ã¨ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚[å…±åŒä½œæˆè€…]ãƒ­ãƒ¼ãƒ«ã‚’ä»˜ã‘ãŸã‚Šã—ãªãŒã‚‰ç®¡ç†ã‚’ã—ã¦ã„ã‚‹ã¨ã€è‡ªåˆ†ã¯ä½•ã§ã‚‚ã§ãã‚‹ã‚“ã ã¨æ€ã£ã¦å½“ãŸã‚Šå‰ã«æ„Ÿã˜ã‚‹ã“ã¨ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ãŒã€å®Ÿã¯ãã†ã§ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®ã‚ãŸã‚Šã®ã€Azure Storage Accountã®æ¨©é™å‘¨ã‚Šã‚’å†è€ƒã—ã¦ã„ã¦ã€ã‚ã‹ã‚Šã¥ã‚‰ã„ã¨ã“ã‚ãŒã‚ã£ãŸã®ã§ç°¡å˜ã«ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚

# ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³æ“ä½œã¨ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ¼ãƒ³æ“ä½œ
ãã‚‚ãã‚‚Azureå«ã‚ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ä¸Šã«ãŠã‘ã‚‹æ“ä½œã¯ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã¨ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ¼ãƒ³ã¨ã„ã†2ç¨®é¡ã®ã‚«ãƒ†ã‚´ãƒªã«åˆ†ã‘ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«=åˆ¶å¾¡ãªã®ã§ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³æ“ä½œã¯ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å†…ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ¼ãƒ³æ“ä½œã¯ãƒªã‚½ãƒ¼ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã‚‹æ©Ÿèƒ½ã®åˆ©ç”¨ã«ä½¿ç”¨ã—ã¾ã™ã€‚ãŸã¨ãˆã°ã€

> ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« ãƒ—ãƒ¬ãƒ¼ãƒ³ã‚’ä½¿ã£ã¦ Azure Cosmos DB ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ Azure Cosmos DB ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ ãƒ—ãƒ¬ãƒ¼ãƒ³ã‚’ä½¿ã„ã¾ã™ã€‚

ã“ã‚Œã‚‰ã¯ãã‚Œãã‚Œã®æ“ä½œã«ãŠã„ã¦åˆ©ç”¨ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®é•ã„ã«ã‚‚ç¾ã‚Œã¦ãŠã‚Šã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³æ“ä½œã¯ Azure Resource Manager ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ(`https://management.azure.com`)ã«é€ä¿¡ã•ã‚Œã‚‹ã®ã«å¯¾ã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ¼ãƒ³æ“ä½œã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å›ºæœ‰ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾ã—ã¦é€ä¿¡ã•ã‚Œã¾ã™ã€‚

ã“ã‚Œã‚‰ã®æ“ä½œã®é•ã„ã¯ã€RBACãƒ­ãƒ¼ãƒ«å®šç¾©ä¸Šã«ãŠã‘ã‚‹Actionsã¨DataActionsã¨ã„ã£ãŸé•ã„ã¨ã—ã¦ç¾ã‚Œã¦ãã¾ã™ã€‚

# ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’è€ƒãˆã‚‹

ä¾‹ãˆã°ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚ˆã†ã«BLOBã®ç®¡ç†ã‚’ã—ãŸã„ã¨æ€ã£ãŸå ´åˆã€ã“ã‚Œã¯ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ¼ãƒ³ã®æ“ä½œã«ãªã‚‹ãŸã‚ã€DataActionã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚ã—ã‹ã—ã€æ”¹ã‚ã¦[å…±åŒä½œæˆè€…]ãƒ­ãƒ¼ãƒ«ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«`dataActions`ã¯ä½•ã‚‚å…¥ã£ã¦ã„ã¾ã›ã‚“ã€‚
```json
{
    "id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
    "properties": {
        "roleName": "Contributor",
        "description": "Grants full access to manage all resources, but does not allow you to assign roles in Azure RBAC, manage assignments in Azure Blueprints, or share image galleries.",
        "assignableScopes": [
            "/"
        ],
        "permissions": [
            {
                "actions": [
                    "*"
                ],
                "notActions": [
                    "Microsoft.Authorization/*/Delete",
                    "Microsoft.Authorization/*/Write",
                    "Microsoft.Authorization/elevateAccess/Action",
                    "Microsoft.Blueprint/blueprintAssignments/write",
                    "Microsoft.Blueprint/blueprintAssignments/delete",
                    "Microsoft.Compute/galleries/share/action",
                    "Microsoft.Purview/consents/write",
                    "Microsoft.Purview/consents/delete"
                ],
                "dataActions": [],
                "notDataActions": []
            }
        ]
    }
}
```

ä¸€æ–¹ã§ã€BLOBã®ç®¡ç†ã‚’ã—ãŸã„ã¨ãªã£ãŸå ´åˆã«æœ¬æ¥ä»˜ã‘ã‚‰ã‚Œã‚‹ã§ã‚ã‚ã†[ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸BLOBå…±åŒä½œæˆè€…]ã®ãƒ­ãƒ¼ãƒ«å®šç¾©ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚`dataActions`ã®éƒ¨åˆ†ã«ã€BLOBã«å¯¾ã™ã‚‹æ“ä½œã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå­˜åœ¨ã—ã¾ã™ã€‚
```json
{
    "id": "/providers/Microsoft.Authorization/roleDefinitions/ba92f5b4-2d11-453d-a403-e96b0029c9fe",
    "properties": {
        "roleName": "Storage Blob Data Contributor",
        "description": "Allows for read, write and delete access to Azure Storage blob containers and data",
        "assignableScopes": [
            "/"
        ],
        "permissions": [
            {
                "actions": [
                    "Microsoft.Storage/storageAccounts/blobServices/containers/delete",
                    "Microsoft.Storage/storageAccounts/blobServices/containers/read",
                    "Microsoft.Storage/storageAccounts/blobServices/containers/write",
                    "Microsoft.Storage/storageAccounts/blobServices/generateUserDelegationKey/action"
                ],
                "notActions": [],
                "dataActions": [
                    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/delete",
                    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read",
                    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write",
                    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/move/action",
                    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/add/action"
                ],
                "notDataActions": []
            }
        ]
    }
}
```